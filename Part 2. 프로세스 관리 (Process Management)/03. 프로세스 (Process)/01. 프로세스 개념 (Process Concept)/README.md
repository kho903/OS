# 3.1 프로세스 개념 (Process Concept)
- 운영체제에 대해 논의할 때 발생하는 질문은 모든 CPU 활동을 호출하는 것과 관련된다.
- 초기 컴퓨터는 "작업(job)"을 실행하는 일괄처리 시스템이었고, "사용자 프로그램" 또는 "태스크(task)"를 실행하는 시분할 시스템이 뒤를 이었다.
- 단일 사용자 시스템에서도 사용자는 워드 프로세서, 웹 브라우저 및 전자 메일 패키지와 같은 여러 프로그램을 한 번에 실행할 수 있다.
- 멀티 태스킹을 지원하지 않는 임베디드 장치와 같이 컴퓨터가 한 번에 하나의 프로그램만 실행할 수 있더라도 운영체제는 메모리 관리와 같은 자체 프로그램된 내부 활동을 지원해야 할 수도 있다.
- 여러 측면에서 이러한 모든 활동은 유사하므로 이러한 모든 활동을 프로세스라 부를 수 있다.


- 우리는 더 현대적인 용어인 "프로세스"를 선호하지만, 운영체제의 주요 활동이 작업 처리인 시절에 많은 운영체제 이론 및 용어가 개발되었기 때문에 "작업(job)"이라는 용어는 역사적으로 중요한
의미가 있다.
- 따라서 일부 적절한 경우 운영체제의 역할을 설명할 때 작업을 사용한다.
- 예를 들어, 프로세스가 작업이라는 용어를 대체했다는 이유만으로 작업(예: 작업 스케줄링)이라는 단어를 포함한 일반적으로 통용되는 용어를 사용하지 않는 것은 오해의 소지가 있다.

## 3.1.1 프로세스 (The Process)
- 비공식적으로, 프로세스란 실행 중인 프로그램이다. 프로세스의 현재 활동 상태는 프로그램 카운터 값과 프로세서 레지스터의 내용으로 나타낸다.
- 프로세스의 메모리 배치는 일반적으로 여러 섹션으로 구분되며 이러한 섹션에는 다음이 포함된다.
  - 텍스트 섹션 - 실행 코드
  - 데이터 섹션 - 전역 변수
  - 힙 섹션 - 프로그램 실행 중에 동적으로 할당되는 메모리
  - 스택 섹션 - 함수를 호출할 때 임시 데이터 저장장소 (예: 함수 매개변수, 복귀 주소 및 지역 변수)
- 텍스트 및 데이터 섹션의 크기는 고정되기 때문에 실행 시간 동안 크기가 변하지 않는다. 그러나 스택 및 힙 섹션은 프로그램 실행 중에 동적으로 줄어들거나 커질 수 있다.
- 함수가 호출될 때마다 함수 매개변수, 지역 변수 및 복귀 주소를 포함하는 활성화 레코드(activation record)가 스택에 푸시(push)된다. 
- 함수에서 제어가 되돌아오면 스택에서 활성화 레코드가 팝(pop)된다.
- 마찬가지로 메모리가 동적으로 할당됨에 따라 힙이 커지고 메모리가 시스템에 반환되면 축소된다. 스택 및 힙 섹션이 서로의 방향으로 커지더라도 운영체제는 서로 겹치지 않도록 해야 한다.


- 우리는 프로그램 그 자체가 프로세스가 아님을 강조한다.
- 프로그램은 명령어 리스트를 내용을 가진 디스크에 저장된 파일(실행 파일이라고 불림)과 같은 수동적인 존재 (passive entity)이다.
- 이와는 대조적으로 프로세스는 다음에 실행할 명령어를 지정하는 프로그램 카운터와 관련 자원의 집합을 가진 능동적인 존재(active entity)이다.
- 실행 파일이 메모리에 적재될 때 프로그램은 프로세스가 된다. 실행 파일을 메모리에 적재하는 일반적인 두 가지 방식은 실행 파일을 나타내는 아이콘을 더블 클릭하는 방식과 명령어 라인 상에서
prog.exe 또는 a.out 과 같이 파일 이름을 입력하는 방식이다.
- 두 프로세스들이 동일한 프로그램에 연관될 수 있지만, 이들은 두 개의 별도의 실행 순서로 간주한다.
- 예를 들어, 여러 사용자가 메일 프로그램의 서로 다른 복사본을 실행하거나, 또는 동일한 사용자가 웹 브라우저 프로그램의 여러 복사본을 호출할 수 있다. 이들 각각은 별도의 프로세스이며, 
텍스트 섹션이 동등하다 할지라도 데이터, 힙 및 스택 섹션은 다를 수 있다. 프로세스가 실행되는 과정에서 많은 프로세스를 생성하는 것이 보통이다.
- 프로세스 자체가 다른 코드의 실행환경이 될 수 있따. Java 프로그래밍 환경이 좋은 예를 보인다.
- 대부분의 상황에서 실행 가능한 Java 프로그램은 Java 가상기계 (JVM)안에서 실행된다. JVM은 적재된 Java 코드를 해석하고 해당 코드를 대신하여 기계어를 이용하여 행동을 취하는 
프로세스로서 프로그램을 실행한다.
- 예를 들어, 컴파일된 Java 프로그램 Program.class 를 실행하기 위해 `java Program`이라는 명령어를 입력할 것이다.
- java 명령어는 JVM을 일반 프로세스처럼 실행하고, JVM은 Java 프로그램인 Program을 가상기계 안에서 실행한다. 이 개념은 다른 기계어로 작성된 프로그램이 아니라 Java 언어로 작성된
프로그램을 실행시킨다는 점을 제외하면 모의 실험과 동일한 개념이다.

## 3.1.2 프로세스 상태 (Process State)
- 프로세스는 실행되면서 그 상태가 변한다. 프로세스의 상태는 부분적으로 그 프로세스의 현재의 활동에 따라 정의된다. 프로세스는 다음 상태 중 하나이다.
  - new (새로운) : 프로세스가 생성 중이다.
  - running (실행) : 명령어들이 실행되고 있다.
  - waiting (대기) : 프로세스가 어떤 이벤트(입출력 완료 또는 신호 수신)가 일어나기를 기다린다.
  - ready (준비) : 프로세스가 프로세서에 할당되기를 기다린다.
  - terminated (종료) : 프로세스의 실행이 종료되었다.
- 이들 이름은 임의적이고, 운영체제에 따라 다르다. 그러나 이들이 나타내는 상태들은 모든 시스템에서 찾을 수 있다. 특정 운영체제는 프로세스 상태를 더욱 자세하게 묘사하여 구별한다.
- 어느 한 순간에 한 프로세서 코어에서는 오직 하나의 프로세스만이 실행된다는 것을 인식하는 것이 중요하다. 그렇지만 많은 프로세스가 준비완료 및 대기 상태에 있을 수 있다.

## 3.1.3 프로세스 제어 블록 (Process Control Block)
- 각 프로세스는 운영체제에서 프로세스 제어 블록 (process control block, PCB) (테스크 제어 블록이라고도 불리는)에 의해 표현된다. 
- 프로세스 제어 블록은 특정 프로세스와 연관된 여러 정보를 수록하여, 다음과 같은 것들을 포함한다.
  - 프로세스 상태 : 상태는 new (새로운), ready (준비), running (실행), waiting (대기) 또는 halted (정지) 상태 등이다.
  - 프로그램 카운터 : 프로그램 카운터는 이 프로세스가 다음에 실행할 명령어의 주소를 가리킨다.
  - CPU 레지스터들 : CPU 레지스터는 컴퓨터의 구조에 따라 다양한 수와 유형을 가진다. 레지스터에는 누산기 (accumulator), 인덱스 레지스터, 스택 레지스터, 범용 (general-purpose)
    레지스터들과 상태 코드 (condition code) 정보가 포함된다. 프로그램 카운터와 함께 이 상태 정보는, 나중에 프로세스가 다시 스케줄될 때 계속 올바르게 실행되도록 하기 위해서 인터럽트
    발생 시 저장되어야 한다.
  - CPU-스케줄링 정보 : 이 정보는 프로세스 우선순위, 스케줄 큐에 대한 포인터와 다른 스케줄 매개 변수를 포함한다.
  - 메모리 관리 정보 : 이 정보는 운영체제에 의해 사용되는 메모리 시스템에 따라 기준(base) 레지스터와 한계(limit) 레지스터의 값, 운영체제가 사용하는 메모리 시스템에 따라 페이지 테이블
    또는 세그먼트 테이블 등과 같은 정보를 포함한다.
  - 회계 (accounting) 정보 : 이 정보는 CPU 사용 시간과 경과된 실시간, 시간 제한, 계정 번호, 잡 또는 프로세스 번호 등을 포함한다.
  - 입출력 상태 정보 : 이 정보는 이 프로세스에 할당된 입출력 장치들과 열린 파일의 목록 등을 포함한다.
- 요약하면 프로세스 제어 블록은 일부 회계 데이터와 함께 프로세스를 시작시키거나 다시 시작시키는 데 필요한 모든 데이터를 위한 저장소의 역할을 한다.

## 3.1.4 스레드 (Threads)
- 지금까지 논의된 프로세스 모델은 프로세스가 단일의 실행 스레드를 실행하는 프로그램임을 암시했다.
- 예를 들면, 만일 한 스레드가 워드 프로세서 프로그램을 실행 중이면, 실행되는 명령어의 단일 스레드가 존재한다. 이 단일 스레드는 프로세스가 한 번에 단지 한 가지 일만 실행하도록 허용한다. 
따라서 사용자는 문자를 입력하면서 동시에 철자 검사기를 실행할 수 없다.
- 대부분의 현대 운영체제는 프로세스 개념을 확장하여 한 프로세스가 다수의 실행 스레드를 가질 수 있도록 허용한다. 이러한 특성은 여러 스레드가 병렬로 실행될 수 있는 멀티코어 시스템에서 특히
유용하다. 
- 예를 들어, 멀티 스레드 워드 프로세서는 하나의 스레드에 사용자 입력 관리를 맡기는 동안 다른 스레드가 철자 검사기를 수행하도록 만들 수 있다.
- 스레드를 지원하는 시스템에서는 PCB는 각 스레드에 관한 정보를 포함하도록 확장된다. 스레드를 지원하기 위해서는 시스템 전반에 걸친 다른 수정도 필요하다.

